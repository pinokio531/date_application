<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<% request.setCharacterEncoding("utf-8"); %>
<%@ page import ="java.sql.*" %>
<%!
	String location = "구월동";
	String driver="com.mysql.jdbc.Driver";//mysql jdbc드라이버(필수)
	String url ="jdbc:mysql://localhost:3306/project";
	String dbId="root";
	String dbPw="as097531";
	String query1="SELECT * FROM villageData WHERE villageName = ? ";
	String query2="SELECT * FROM shopdb WHERE ? < longtitude < ? AND ? < latitude < ? ";
	double mLongtitude = 1;
	double mLatitude = 1;
	
	Connection con = null;
	PreparedStatement pstmt = null;
	PreparedStatement pstmt2 = null;
	ResultSet rs = null;
	ResultSet result = null;
	
	double testV1 = 0;
	double testV2 = 0;
	%>
<%
	location = (String) request.getAttribute("location");

	Class.forName(driver);//JDBC드라이버가 실제로 적용되는 부분
	con = DriverManager.getConnection(url, dbId, dbPw);
	
	pstmt = con.prepareStatement(query1);
	pstmt.setString(1, location);
	
	rs=pstmt.executeQuery();
	
	if(rs.next()){
		if(location.equals(rs.getString("villageName"))){
			mLongtitude = Double.parseDouble(rs.getString("longtitude"));
			mLatitude = Double.parseDouble(rs.getString("latitude"));
			pstmt2 = con.prepareStatement(query2);
			testV1 = (mLongtitude - (0.001));
			testV2 = (mLongtitude + (0.001));
			pstmt2.setDouble(1, testV1);
			pstmt2.setDouble(2, testV2);
			pstmt2.setDouble(3, (mLatitude - (0.001)));
			pstmt2.setDouble(4, (mLatitude + (0.001)));
			result=pstmt2.executeQuery();
	%>
	<script>
	console.log(<%= testV1%>, <%= testV2%>)
	</script>
	<%
			
		}
	}
	
	%>